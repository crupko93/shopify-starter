{% comment %}
Product JS
---
Define your own product JS Object
Allows us to include properties which aren't available from the default Shopify `product` or `variant` object
{% endcomment %}

{
  "id": {{ temp_prod.id }},
  "available": {{ temp_prod.available | json }},
  "price": {{ temp_prod.price | json }},
  "compareAtPrice": {{ temp_prod.compare_at_price }},
  "title": {{ temp_prod.title | escape | json | replace: '"', "'" }},
  "handle": {{ temp_prod.handle | json }},
  "type": {{ temp_prod.type | json }},
  "description": {{ temp_prod.description | escape | replace: "'", "\'" | json | replace: '"', "'" }},
  "variants": [
    {% for variant in temp_prod.variants %}
      {% comment %}
        `variant.name` is a generate property that is not provided automatically by Shopify
      {% endcomment %}
      {%- assign name = temp_prod.title | append: " - " | append: variant.title -%}
      {
        "id": {{ variant.id }},
        "name": '{{ name | escape | json | replace: '"', "'" }}',
        "price": {{ variant.price }},
        "compare_at_price": {{ variant.compare_at_price | escape | json | replace: '"', "'" }},
        "quantity": {{ variant.inventory_quantity | json }},
        "featured_image": {
          "id": {{ variant.featured_image.id | json }},
          "height": {{ variant.featured_image.height | json }},
          "width": {{ variant.featured_image.width | json }},
          "src": {{ variant.featured_image.src | json }},
          "alt": {{ variant.featured_image.alt | json }}
        }
      },{%- unless forloop.last -%},{%- endunless -%}
    {% endfor %}
  ],
  media: [
    {% for media in temp_prod.media %}
      {
        {% if media.media_type == 'image' %}
          "type": 'image',
          "id": {{ media.id | json }},
          "height": {{ media.height | json }},
          "width": {{ media.width | json }},
          "src": {{ media.src | escape | json }},
          "alt": {{ media.alt | escape | json }}
        {% endif %}
        {% if media.media_type == 'video' %}
          "type": 'video',
          "tag": {{ media | video_tag: controls: false, autoplay: true, muted: true, playsinline: true, loop: true, image_size: "1024x" | escape | json | replace: '"', "'" }},
          "id": {{ media.id }},
          "src": {{ media.preview_image | image_url: width: 750, height: 750, crop: 'center' | json }}
        {% endif %}
      },
    {% endfor %}
  ],
}